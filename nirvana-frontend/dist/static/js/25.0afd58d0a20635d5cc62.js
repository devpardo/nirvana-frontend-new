webpackJsonp([25],{302:function(t,e,n){n(853);var i=n(5)(n(484),n(766),"data-v-d6e84686",null);i.options.__file="/Users/bryanpardo/Development/nirvana-frontend/src/views/Message/Notifications.vue",i.esModule&&Object.keys(i.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] Notifications.vue: functional components are not supported with templates, they should use render functions."),t.exports=i.exports},338:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(75),o=(n.n(i),n(76)),a=n.n(o);e.default={name:"InfiniteScroll",props:["fetchHandler","items","loading","totalFetched","q"],methods:{loadMore:function(){this.q.page&&this.items.length&&(this.totalFetched?this.q.page>1&&this.$toast({message:"无更多数据可加载",position:"middle",duration:2e3}):(this.q.page=this.q.page+1,this.fetchHandler&&this.fetchHandler()))}},components:{InfiniteScroll:a.a}}},339:function(t,e,n){e=t.exports=n(1)(),e.push([t.i,".infinit-scroll-wrap {\n  position: relative;\n  height: 100%;\n  overflow: scroll;\n}\n\n.loading {\n  text-align: center;\n}\n\n.load-position {\n  margin: 0 auto;\n  display: inline-block;\n  left: -0.133333rem;\n  top: 0.133333rem;\n  position: relative;\n}\n\n.load-txt {\n  position: relative;\n  top: -0.133333rem;\n}",""])},340:function(t,e,n){n(342);var i=n(5)(n(338),n(341),null,null);i.options.__file="/Users/bryanpardo/Development/nirvana-frontend/src/components/Shared/InfiniteScroll.vue",i.esModule&&Object.keys(i.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] InfiniteScroll.vue: functional components are not supported with templates, they should use render functions."),t.exports=i.exports},341:function(t,e,n){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"infinit-scroll-wrap"},[n("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"10"}},[t._t("top"),t._v(" "),t._l(t.items,function(e,i){return n("div",{key:i},[t._t("default",null,{item:e,index:i})],2)}),t._v(" "),t._t("bottom"),t._v(" "),t.loading&&!t.items.length?n("p",{staticClass:"loading"},[n("mt-spinner",{staticClass:"load-position",attrs:{type:"fading-circle"}}),t._v(" "),n("span",{staticClass:"load-txt"},[t._v("加载中")])],1):t._e()],2)])},staticRenderFns:[]},t.exports.render._withStripped=!0},342:function(t,e,n){var i=n(339);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(2)("4d47160c",i,!1)},355:function(t,e,n){"use strict";var i=n(24),o=n.n(i);e.a={data:function(){return{items:[],loading:!1,firstFetched:!1,q:{page:1,per_page:10},paginateMeta:null}},computed:{totalFetched:function(){return this.firstFetched&&this.items&&this.items.length===this.paginateMeta.total_count}},methods:{beforeFetch:function(){this.loading=!0},fetchData:function(){},_fetchData:function(t){var e=this;return new o.a(function(n,i){e.beforeFetch(),t.then(function(t){t.data.items&&(1===e.q.page?e.items=t.data.items:e.items=e.items.concat(t.data.items),e.afterFetch(t.data),n(t))}).catch(function(t){e.loading=!1,i(t)})})},afterFetch:function(t){this.firstFetched=!0,this.loading=!1,this.q.page=t.paginate_meta.page||this.q.page,this.q.per_page=t.paginate_meta.per_page||this.q.per_page,this.paginateMeta=t.paginate_meta}}}},484:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(340),o=n.n(i),a=n(355);e.default={mixins:[a.a],data:function(){return{unread_count:""}},mounted:function(){var t={navigateTitle:!1};this.$store.dispatch("setNavigationTitle",t),this.fetchData()},components:{InfiniteScroll:o.a},methods:{fetchData:function(){var t=this;this._fetchData(this.api.getNotifications({per_page:this.q.per_page,page:this.q.page})).then(function(e){t.unread_count=e.data.unread_count})},goNotifyDetail:function(t){this.$router.push({name:"NotificationDetail",params:{notificationId:t}})},handleDeleteNotify:function(t){var e=this;this.$messagebox.confirm("您确定要删除?","确认删除").then(function(n){e.api.deleteNotify(t).then(function(){e.$toast({message:"删除成功",position:"middle",duration:5e3}),e.items.length=0,e.q.page=1,e.firstFetched=!1,e.fetchData()}).catch(function(t){console.log(t)})}).catch(function(t){console.log(t)})},handleNotifyRead:function(t){var e=this;this.api.postNotifyRead(t).then(function(){e.items.length=0,e.q.page=1,e.fetchData()}).catch(function(t){console.log(t)})},handleReadAll:function(){var t=this;this.api.postReadAll().then(function(){t.items.length=0,t.q.page=1,t.fetchData()}).catch(function(t){console.log(t)})}}}},603:function(t,e,n){e=t.exports=n(1)(),e.push([t.i,".body[data-v-d6e84686] {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n\n.all-read[data-v-d6e84686] {\n  margin: 0.266667rem auto;\n  width: 90%;\n  padding: 0.266667rem 0;\n  color: #749DDE;\n  background-color: #ffffff;\n  font-weight: bold;\n  text-align: center;\n  font-size: 0.373333rem;\n  border-radius: 0.133333rem;\n}\n\n.p-bottom[data-v-d6e84686] {\n  padding-bottom: 1.6rem;\n}\n\n.action[data-v-d6e84686] {\n  text-align: right;\n  font-size: 0.32rem;\n  margin-top: 0.266667rem;\n}\n\n.action .red[data-v-d6e84686] {\n  color: #cb202d;\n  border: 0.032rem solid #cb202d;\n}\n\n.action .yellow[data-v-d6e84686] {\n  color: #fcd667;\n  border: 0.032rem solid #fcd667;\n  padding: .1rem .5rem;\n}\n\n.action span[data-v-d6e84686] {\n  padding: 0.053333rem 0.266667rem;\n  border-radius: 0.133333rem;\n  margin: 0 0.16rem;\n}\n\n.notification[data-v-d6e84686] {\n  padding: 0 .3rem;\n  margin: .3rem 0;\n}\n\n.notification .date[data-v-d6e84686] {\n  font-size: 0.32rem;\n  color: rgba(255, 255, 255, 0.5);\n  padding-right: 0.266667rem;\n}\n\n.notification .info[data-v-d6e84686] {\n  border-bottom: 0.032rem solid #0b0e31;\n  padding-bottom: 0.266667rem;\n}\n\n.notification .content[data-v-d6e84686] {\n  margin: 0 auto;\n  margin-top: 0.266667rem;\n  background-color: #122151;\n  padding: .5rem .3rem;\n  border-radius: 0.133333rem;\n  font-size: 0.373333rem;\n}\n\n.notification .content .limit[data-v-d6e84686] {\n  width: 100%;\n  color: #424242;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  display: inline-block;\n}\n\n.notification .content .grey[data-v-d6e84686] {\n  color: #ffffff;\n}\n\n.notification .more[data-v-d6e84686] {\n  font-size: 0.32rem;\n  color: #749DDE;\n  display: inline-block;\n  text-decoration: underline;\n}",""])},766:function(t,e,n){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"body"},[n("infinite-scroll",{attrs:{fetchHandler:t.fetchData,items:t.items,loading:t.loading,q:t.q,totalFetched:t.totalFetched},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.item;return[n("div",{staticClass:"notification clearfix"},[n("div",{staticClass:"content"},[n("span",{staticClass:"limit",class:{grey:i.user_read_at}},[t._v(t._s(i.title||"无"))]),t._v(" "),n("div",{staticClass:"info"},[n("span",{staticClass:"date"},[t._v(t._s(i.created_at||"无"))]),i.content?n("span",{staticClass:"more",on:{click:function(e){t.goNotifyDetail(i.id)}}},[t._v(" 点击查看详情 >>")]):t._e()]),t._v(" "),n("div",{staticClass:"action"},[n("span",{staticClass:"yellow",on:{click:function(e){t.handleDeleteNotify(i.id)}}},[t._v("删除")]),i.user_read_at?t._e():n("span",{staticClass:"yellow",on:{click:function(e){t.handleNotifyRead(i.id)}}},[t._v("标记为已读")])])])])]}}])},[t.items.length>0&&t.unread_count?n("template",{slot:"top"},[n("div",{staticClass:"all-read",on:{click:function(e){t.handleReadAll()}}},[t._v("全部标记为已读")])]):t._e(),t._v(" "),n("template",{slot:"bottom"},[t.firstFetched&&!t.items.length?n("p",{staticClass:"no-data"},[t._v("无通知消息")]):t._e()])],2)],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},853:function(t,e,n){var i=n(603);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(2)("6b1707f0",i,!1)}});