webpackJsonp([27],{323:function(e,i,t){t(772);var n=t(5)(t(506),t(686),"data-v-02ffdd9e",null);n.options.__file="/Users/bryanpardo/Development/nirvana-frontend/src/views/Setting/ProfileEdit.vue",n.esModule&&Object.keys(n.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),n.options.functional&&console.error("[vue-loader] ProfileEdit.vue: functional components are not supported with templates, they should use render functions."),e.exports=n.exports},459:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={props:["verification","sign","profile","methods"],data:function(){return{close:this.$fontawesome("close"),checkCircle:this.$fontawesome("check-circle"),codeData:""}},methods:{signOk:function(){this.methods.updateProfile(),this.closed()},closed:function(){this.codeData="",this.verification&&(this.verification.code=!1,this.verification.show=!1,this.verification.flag=!1),this.sign&&(this.sign.flag=!1)},getCode:function(){0===this.verification.type?this.methods.fetchEmailVerifyCode():1===this.verification.type&&this.methods.fetchMobileVerifyCode()},goConfirm:function(){0===this.verification.type?this.methods.emailCreate(this.codeData):1===this.verification.type&&this.methods.mobileCreate(this.codeData)}}}},506:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=t(29),o=t.n(n),a=t(677),r=t.n(a),s=t(74);i.default={data:function(){return{signOut:this.$fontawesome("sign-out"),dataFlag:!1,emailDisabled:!1,photo:"",bank_card_count:"",gender:"",birthday:"",realname:"",method:{fetchMobileVerifyCode:this.fetchMobileVerifyCode,fetchEmailVerifyCode:this.fetchEmailVerifyCode,mobileCreate:this.mobileCreate,emailCreate:this.emailCreate,updateProfile:this.updateProfile},sign:{flag:!1,content:""},verification:{show:!1,type:0,code:!1,count:60,button:!1,flag:!1},profile:{mobile:"",mobile_confirmed_at:"",email:"",email_confirmed_at:"",desc:"",zGender:""}}},methods:{goInfoEdit:function(e){return 1===e&&this.realname?void this.$toast({message:"真实姓名仅能编辑一次,不能再修改",position:"middle",duration:5e3}):3===e&&this.birthday?void this.$toast({message:"生日仅能编辑一次,不能再修改",position:"middle",duration:5e3}):(localStorage.setItem("profileInfo",e),void this.$router.push("/setting/profile_info_edit"))},goMyBanks:function(){this.$router.push({name:"Banks"}),localStorage.setItem("banks",2)},fetchProfile:function(){var e=this;this.api.getProfile().then(function(i){e.profile.mobile=i.data.mobile,e.profile.email=i.data.email,e.profile.email&&(e.emailDisabled=!0),e.profile.mobile_confirmed_at=null===i.data.mobile_confirmed_at,e.profile.email_confirmed_at=null===i.data.email_confirmed_at,e.profile.desc=i.data.desc,e.bank_card_count=i.data.bank_card_count,e.photo=i.data.aws_url,e.gender=null!==i.data.gender&&(i.data.gender?"女":"男"),e.birthday=i.data.birthday,e.realname=i.data.realname,e.dataFlag=!0}).catch(function(e){console.log(e)})},updateProfile:function(){var e=this;if(!this.profile.desc)return void this.$toast({message:"不能为空",position:"middle",duration:5e3});var i={desc:this.profile.desc};this.api.updateProfile(i).then(function(){}).catch(function(i){e.$toast({message:"信息保存失败",position:"middle",duration:5e3}),console.log(i)})},logOut:function(){var e=this,i=o.a.get("accessToken");this.api.logOut(i).then(function(){e.$store.dispatch("removeUserInfo"),o.a.remove("accessToken"),e.$router.push("/start_index"),e.$toast({message:"已退出",position:"middle",duration:5e3})}).catch(function(e){console.log(e)})},goEConfirm:function(e){return 0!==e||t.i(s.d)("email",this.profile.email)?1!==e||t.i(s.d)("mobile",this.profile.mobile)?(this.verification.button=!1,this.verification.type=e,void(this.verification.show=!0)):void this.$toast({message:"手机格式不对",position:"middle",duration:5e3}):void this.$toast({message:"邮箱格式不对",position:"middle",duration:5e3})},fetchMobileVerifyCode:function(){var e=this;this.verification.code=!0;var i=setInterval(function(){0===--e.verification.count&&(e.verification.code=!1,e.verification.count=60,window.clearInterval(i))},1e3);this.api.postMobileVerifyCode(this.profile.mobile).then(function(){e.$toast({message:"已发送验证码，请注意查收",position:"middle",duration:5e3})}).catch(function(e){window.clearInterval(i),console.log(e)})},fetchEmailVerifyCode:function(){var e=this;this.api.postEmailVerifyCode(this.profile.email).then(function(){e.verification.code=!0,e.$toast({message:"已发送验证码，请注意查收",position:"middle",duration:5e3})}).catch(function(e){console.log(e)})},mobileCreate:function(e){var i=this;if(!this.profile.mobile||!e)return void this.$toast({message:"手机号或验证码不能为空",position:"middle",duration:5e3});this.api.mobileCreate(this.profile.mobile,e).then(function(){i.fetchProfile(),i.$toast({message:"手机绑定成功",position:"middle",duration:5e3}),i.verification.flag=!0,i.verification.type=-1}).catch(function(e){console.log(e)})},emailCreate:function(e){var i=this;if(!this.profile.email||!e)return void this.$toast({message:"邮箱地址或验证码不能为空",position:"middle",duration:5e3});this.api.emailCreate(this.profile.email,e).then(function(){i.fetchProfile(),i.$toast({message:"邮箱绑定成功",position:"middle",duration:5e3}),i.verification.flag=!0,i.verification.type=-1}).catch(function(e){console.log(e)})}},mounted:function(){var e={navigateTitle:!1};this.$store.dispatch("setNavigationTitle",e),this.fetchProfile()},components:{VerificationCode:r.a}}},522:function(e,i,t){i=e.exports=t(1)(),i.push([e.i,"p[data-v-02ffdd9e] {\n  margin: 0;\n  padding: 0;\n}\n\n.block[data-v-02ffdd9e] {\n  margin: .3rem;\n}\n\n.block .mint-cell[data-v-02ffdd9e] {\n  background-color: #122151;\n  border: 0.032rem solid #122151;\n  color: #ffffff;\n}\n\n.img[data-v-02ffdd9e] {\n  width: 1.706667rem;\n  height: 1.706667rem;\n  padding: .3rem;\n}\n\n.img > img[data-v-02ffdd9e] {\n  border-radius: 50%;\n}\n\n.mint-radiolist[data-v-02ffdd9e] {\n  display: inherit;\n}\n\n.sign-out[data-v-02ffdd9e] {\n  margin: 0 .3rem;\n  height: 1.2rem;\n  line-height: 1.2rem;\n  background-color: #0b0e31;\n  border: 0.032rem solid #fcd667;\n  border-radius: 2rem;\n  margin-top: 0.266667rem;\n  color: #fcd667;\n  font-weight: bold;\n  text-align: center;\n}\n\n.sign-out .fa[data-v-02ffdd9e] {\n  padding-right: 0.133333rem;\n  font-size: 0.48rem;\n  vertical-align: middle;\n}\n\n.sign-color[data-v-02ffdd9e] {\n  color: #fcd667;\n}\n\n.confirm[data-v-02ffdd9e] {\n  color: #F6A623;\n}\n\n.finished[data-v-02ffdd9e] {\n  color: #C6CCCC;\n}",""])},581:function(e,i,t){i=e.exports=t(1)(),i.push([e.i,"p[data-v-7a9e241e] {\n  margin: 0;\n  padding: 0;\n}\n\ninput[data-v-7a9e241e],\nbutton[data-v-7a9e241e] {\n  border: none;\n}\n\ninput[data-v-7a9e241e] {\n  font-size: 0.373333rem;\n}\n\nbutton[data-v-7a9e241e] {\n  font-size: 0.346667rem;\n}\n\ninput[data-v-7a9e241e]:-moz-placeholder {\n  font-size: 0.346667rem;\n}\n\n[data-v-7a9e241e]::-webkit-input-placeholder {\n  font-size: 0.346667rem;\n}\n\n.verification[data-v-7a9e241e] {\n  width: 8rem;\n  min-height: 4.266667rem;\n  border-radius: 0.133333rem;\n  padding-bottom: 0.533333rem;\n  background-color: #122151;\n  position: absolute;\n  top: 15%;\n  left: 50%;\n  margin-left: -4rem;\n  z-index: 90;\n}\n\n.verification .v-grey[data-v-7a9e241e] {\n  background-color: #C6CCCC;\n  color: #ffffff;\n}\n\n.verification .v-white[data-v-7a9e241e] {\n  background-color: #F6F6F6;\n  border: 0.032rem solid #C6CCCC;\n  border-radius: 0.133333rem;\n}\n\n.verification .v-header[data-v-7a9e241e] {\n  padding: .3rem;\n  width: 100%;\n  border-top-left-radius: 0.133333rem;\n  border-top-right-radius: 0.133333rem;\n  text-align: center;\n  color: #ffffff;\n  background-color: #0b0e31;\n  font-size: 0.373333rem;\n}\n\n.verification .v-header .fa[data-v-7a9e241e] {\n  vertical-align: middle;\n  display: inline-block;\n  font-size: 0.48rem;\n}\n\n.verification .v-content[data-v-7a9e241e] {\n  width: 100%;\n}\n\n.verification .v-content .dl[data-v-7a9e241e] {\n  display: inline-block;\n}\n\n.verification .v-content .v-textarea[data-v-7a9e241e] {\n  min-height: 3.2rem;\n  padding: .3rem;\n}\n\n.verification .v-content textarea[data-v-7a9e241e] {\n  width: 100%;\n  min-height: 3.2rem;\n  border: none;\n  background-color: #0b0e31;\n  color: #ffffff;\n  font-size: 0.373333rem;\n  font-weight: bold;\n  padding: .3rem;\n}\n\n.verification .v-content textarea[data-v-7a9e241e]::-webkit-input-placeholder {\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.verification .v-content textarea[data-v-7a9e241e]:-ms-input-placeholder {\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.verification .v-content textarea[data-v-7a9e241e]::placeholder {\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.verification .v-content .v-mobile[data-v-7a9e241e] {\n  padding: .3rem;\n  margin-bottom: 0.533333rem;\n}\n\n.verification .v-content .v-phone[data-v-7a9e241e] {\n  padding: 0 .3rem;\n  line-height: 1.2rem;\n  background-color: #0b0e31;\n  border: 0.032rem solid rgba(62, 174, 237, 0.2);\n  color: #ffffff;\n  font-weight: bold;\n  width: 100%;\n  border-radius: .1rem;\n  margin-bottom: 0.266667rem;\n}\n\n.verification .v-content .v-code[data-v-7a9e241e] {\n  padding: 0 .3rem;\n  height: 1.2rem;\n  background-color: #0b0e31;\n  border: 0.032rem solid rgba(62, 174, 237, 0.2);\n  width: 50%;\n  border-radius: .1rem;\n  margin-right: .3rem;\n  color: #ffffff;\n  font-weight: bold;\n}\n\n.verification .v-content .v-button[data-v-7a9e241e] {\n  padding: 0 .3rem;\n  line-height: 1.1rem;\n  background-color: #fcd667;\n  border: 0.032rem solid #F8E81C;\n  font-weight: bold;\n  position: absolute;\n  width: 42%;\n  border-radius: .1rem;\n  text-align: center;\n}\n\n.verification .v-content .v-black[data-v-7a9e241e] {\n  background-color: #E7E7E7;\n  opacity: 0.6;\n}\n\n.verification .v-content .v-info[data-v-7a9e241e] {\n  color: #999999;\n  padding-left: 0.133333rem;\n  padding-top: 0.133333rem;\n  display: inline-block;\n}\n\n.verification .v-footer[data-v-7a9e241e] {\n  text-align: center;\n  margin: 0 auto;\n}\n\n.verification .v-footer .v-confirm[data-v-7a9e241e] {\n  padding: .2rem 2rem;\n  font-size: 0.373333rem;\n  font-weight: bold;\n  background-color: #fcd667;\n  border: 0.032rem solid #F8E81C;\n  border-radius: 2rem !important;\n  display: inline-block;\n  word-spacing: 0.053333rem;\n}\n\n.verification .v-footer .v-spacing[data-v-7a9e241e] {\n  letter-spacing: 0.053333rem;\n  border-radius: 0.08rem;\n}\n\n.verified[data-v-7a9e241e] {\n  margin: 0.266667rem auto;\n  margin-top: 1.066667rem;\n  text-align: center;\n  color: #3F880B;\n}\n\n.verified .fa[data-v-7a9e241e] {\n  font-size: 0.96rem;\n}\n\n.verified p[data-v-7a9e241e]:first-child {\n  margin-bottom: 0.266667rem;\n}\n\n.mask-layer[data-v-7a9e241e] {\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: black;\n  opacity: 0.5;\n  z-index: 80;\n}",""])},677:function(e,i,t){t(831);var n=t(5)(t(459),t(744),"data-v-7a9e241e",null);n.options.__file="/Users/bryanpardo/Development/nirvana-frontend/src/components/Setting/VerificationCode.vue",n.esModule&&Object.keys(n.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),n.options.functional&&console.error("[vue-loader] VerificationCode.vue: functional components are not supported with templates, they should use render functions."),e.exports=n.exports},686:function(e,i,t){e.exports={render:function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticClass:"body"},[t("div",{attrs:{id:"body"}},[t("div",{staticClass:"block"},[t("mt-cell",{attrs:{title:"我的头像","is-link":"",to:"/setting/profile/photo/edit"}},[t("span",{staticClass:"img"},[t("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.photo,expression:"photo"}],attrs:{width:"100%",height:"100%"}})])]),e._v(" "),t("mt-cell",{attrs:{title:"个性签名"}},[t("span",{staticClass:"sign-color",on:{click:function(i){e.sign.flag=!0}}},[e._v("点击编辑")])]),e._v(" "),e.sign.flag?t("verification-code",{attrs:{sign:e.sign,profile:e.profile,methods:e.method}}):e._e()],1),e._v(" "),t("div",{staticClass:"block"},[t("mt-cell",{attrs:{title:"真实姓名","is-link":""},nativeOn:{click:function(i){e.goInfoEdit(1)}}},[e.realname?t("span",[e._v(e._s(e.realname))]):e._e()]),e._v(" "),t("mt-cell",{attrs:{title:"性别","is-link":""},nativeOn:{click:function(i){e.goInfoEdit(2)}}},[e.gender?t("span",[e._v(e._s(e.gender))]):e._e()]),e._v(" "),t("mt-cell",{attrs:{title:"出生日","is-link":""},nativeOn:{click:function(i){e.goInfoEdit(3)}}},[e.birthday?t("span",[e._v(e._s(e.birthday))]):e._e()])],1),e._v(" "),t("div",{staticClass:"block",attrs:{id:"scroll"}},[t("mt-field",{attrs:{label:"电子邮箱",placeholder:"电子邮箱",type:"email",disabled:!e.profile.email_confirmed_at||e.emailDisabled},model:{value:e.profile.email,callback:function(i){e.profile.email=i},expression:"profile.email"}},[e.profile.email&&e.profile.email_confirmed_at?t("span",{staticClass:"confirm",on:{click:function(i){e.goEConfirm(0)}}},[e._v("验证邮箱")]):e._e(),e.dataFlag&&!e.profile.email_confirmed_at?t("span",{staticClass:"finished"},[e._v("已验证")]):e._e()]),e._v(" "),t("mt-field",{attrs:{label:"手机号码",placeholder:"手机号码",type:"tel",disabled:!e.profile.mobile_confirmed_at},model:{value:e.profile.mobile,callback:function(i){e.profile.mobile=i},expression:"profile.mobile"}},[e.profile.mobile&&e.profile.mobile_confirmed_at?t("span",{staticClass:"confirm",on:{click:function(i){e.goEConfirm(1)}}},[e._v("验证手机号")]):e._e(),e.dataFlag&&!e.profile.mobile_confirmed_at?t("span",{staticClass:"finished"},[e._v("已验证")]):e._e()]),e._v(" "),t("mt-cell",{attrs:{title:"银行卡","is-link":""},nativeOn:{click:function(i){e.goMyBanks()}}},[t("span",[e._v(e._s(e.bank_card_count||"0"))])]),e._v(" "),t("mt-cell",{attrs:{title:"登录密码","is-link":"",to:"/setting/change_password"}},[t("span",[e._v("修改密码")])])],1),e._v(" "),t("p",{staticClass:"sign-out",on:{click:function(i){e.logOut()}}},[t("span",{staticClass:"fa"},[e._v(e._s(e.signOut))]),t("span",[e._v("退出登录")])]),e._v(" "),e.verification.show?t("verification-code",{attrs:{verification:e.verification,profile:e.profile,methods:e.method}}):e._e()],1)])},staticRenderFns:[]},e.exports.render._withStripped=!0},744:function(e,i,t){e.exports={render:function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",[t("div",{staticClass:"verification"},[t("div",{staticClass:"v-header"},[e.sign&&e.sign.flag?t("span",[e._v("编辑个性签名")]):e._e(),e._v(" "),e.verification&&1===e.verification.type?t("span",[e._v("手机验证")]):e._e(),e._v(" "),e.verification&&0===e.verification.type?t("span",[e._v("邮箱验证")]):e._e(),e._v(" "),e.verification&&e.verification.flag?t("span",[e._v("验证成功")]):e._e(),e._v(" "),t("span",{staticClass:"fa fr",on:{click:e.closed}},[e._v(e._s(e.close))])]),e._v(" "),t("div",{staticClass:"v-content"},[e.sign&&e.sign.flag?t("div",{staticClass:"v-textarea"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.profile.desc,expression:"profile.desc"}],attrs:{placeholder:"个性签名"},domProps:{value:e.profile.desc},on:{input:function(i){i.target.composing||(e.profile.desc=i.target.value)}}})]):e._e(),e._v(" "),e.verification&&1===e.verification.type?t("div",{staticClass:"v-mobile"},[e.profile?t("input",{directives:[{name:"model",rawName:"v-model",value:e.profile.mobile,expression:"profile.mobile"}],staticClass:"v-phone",attrs:{placeholder:"手机号",disabled:"disabled"},domProps:{value:e.profile.mobile},on:{input:function(i){i.target.composing||(e.profile.mobile=i.target.value)}}}):e._e(),e._v(" "),t("p",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.codeData,expression:"codeData"}],staticClass:"v-code dl",attrs:{placeholder:"验证码"},domProps:{value:e.codeData},on:{input:function(i){i.target.composing||(e.codeData=i.target.value)}}}),e._v(" "),e.verification.code||e.verification.count<60?t("span",{staticClass:"v-button v-black dl"},[e._v(e._s(e.verification.count)+"s后重新获取")]):t("span",{staticClass:"v-button v-white dl",on:{click:function(i){e.getCode()}}},[e._v("获取验证码")])]),e._v(" "),t("p",{staticClass:"v-info"},[e._v("点击左侧按钮获取手机验证码")])]):e._e(),e._v(" "),e.verification&&0===e.verification.type?t("div",{staticClass:"v-mobile"},[e.profile?t("input",{directives:[{name:"model",rawName:"v-model",value:e.profile.email,expression:"profile.email"}],staticClass:"v-phone",attrs:{placeholder:"电子邮箱",disabled:"disabled"},domProps:{value:e.profile.email},on:{input:function(i){i.target.composing||(e.profile.email=i.target.value)}}}):e._e(),e._v(" "),t("p",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.codeData,expression:"codeData"}],staticClass:"v-code dl",attrs:{placeholder:"验证码"},domProps:{value:e.codeData},on:{input:function(i){i.target.composing||(e.codeData=i.target.value)}}}),e._v(" "),e.verification.code?t("span",{staticClass:"v-button v-grey dl"},[e._v("注意查收邮件")]):t("span",{staticClass:"v-button v-white dl",on:{click:function(i){e.getCode()}}},[e._v("获取验证码")])]),e._v(" "),t("p",{staticClass:"v-info"},[e._v("点击左侧按钮获取电子邮箱验证码")])]):e._e(),e._v(" "),e.verification&&e.verification.flag?t("div",{staticClass:"verified"},[t("p",[t("span",{staticClass:"fa"},[e._v(e._s(e.checkCircle))])]),e._v(" "),t("p",[e._v("尊敬的用户，恭喜您已通过验证")])]):e._e()]),e._v(" "),e.verification&&!e.verification.flag||e.sign?t("div",{staticClass:"v-footer"},[e.sign&&e.sign.flag?t("span",{staticClass:"v-confirm v-white v-spacing",on:{click:function(i){e.signOk()}}},[e._v("确认")]):t("button",{staticClass:"v-confirm v-spacing",class:[e.verification.button?"v-grey":"v-white"],attrs:{disabled:e.verification.button},on:{click:function(i){e.goConfirm()}}},[e._v("进行验证")])]):e._e()]),e._v(" "),t("div",{staticClass:"mask-layer"})])},staticRenderFns:[]},e.exports.render._withStripped=!0},772:function(e,i,t){var n=t(522);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);t(2)("272dca24",n,!1)},831:function(e,i,t){var n=t(581);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);t(2)("61b42fcd",n,!1)}});